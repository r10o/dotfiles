#!/usr/bin/sh

if [ $(pgrep -cx bar) -gt 1 ] ; then
    printf "%s\n" "The panel is already running." >&2
    exit 1
fi

[ -e "$PANEL_FIFO" ] && rm "$PANEL_FIFO"
mkfifo "$PANEL_FIFO"

bspc control --subscribe > "$PANEL_FIFO" &
xtitle -sf 'T%s' > "$PANEL_FIFO" &
clock -sf 'C%I:%M %p' > "$PANEL_FIFO" & 
bat > "$PANEL_FIFO" &
music > "$PANEL_FIFO" &
net > "$PANEL_FIFO" &
vol > "$PANEL_FIFO" &

. config_bar

cat "$PANEL_FIFO" | build | dzen2 -h $height -dock -ta l -title-name panel -fn "${font}:pixelsize=${font_size}" -fg "$COLOR_FOREGROUND" -bg "$COLOR_BACKGROUND" -e "button3=" &

wait
